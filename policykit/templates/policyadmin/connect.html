{% extends "base.html" %}
{% load i18n static %}

{% block extrahead %}
<!-- <script src={% static "policyengine/js/jquery-3.4.1.min.js" %}></script> -->
<script src={% static "policyengine/js/login.js" %}></script>
{% endblock %}

{% block bodyclass %}{{ block.super }} login {% endblock %}

{% block usertools %}{% endblock %}

{% block nav-global %}{% endblock %}

{% block content_title %}{% endblock %}

{% block breadcrumbs %}{% endblock %}

{% block content %}

<main class="flex min-h-screen items-center justify-between">
  <div
    class="w-2/5 h-full min-h-screen"
    style="background: linear-gradient(243deg, rgba(222, 195, 252, 0.57) 1.25%, rgba(196, 196, 252, 0.68) 45.36%, #99C4FC 97.5%)",
  ></div>
  <div class="grow">
    <div class="max-w-sm mb-32 mx-auto">
      <h1 class="mb-8">Connect PolicyKit to your home platform</h1>
      <p class="large mb-16">
        Note that only Admins (Moderators) can connect PolicyKit to community platforms.
      </p>
      <a href="/authorize_platform?platform=slack&type=app">
        Install PolicyKit to Slack
      </a>
      {% if request.GET.success %}
        Successfully added PolicyKit!
      {% endif %}
      {% if request.GET.error %}
        <div class="error">
          {% if request.GET.error == 'slack_wrong_community' %}
            PolicyKit is already installed to your Slack workspace! Sign in with Slack to continue.
          {% elif request.GET.error == 'slack_installer_is_not_admin' %}
            Installation failed! Only Slack workspace admins are permitted to install PolicyKit.
          {% elif request.GET.error == 'discord_wrong_community' %}
            PolicyKit is already installed to your Discord guild! Sign in with Discord to continue.
          {% elif request.GET.error == 'discord_installer_is_not_admin' %}
            Installation failed! Only Discord guild owners are permitted to install PolicyKit.
          {% elif request.GET.error_description %}
            {{ request.GET.error_description }}
          {% else %}
            Error: {{ request.GET.error }}
          {% endif %}
        </div>
      {% endif %}
      <p>
        Already connected?
        <a class="ml-2.5" href="/login">
          Sign in
        </a>
      </p>
    </div>
  </div>
</main>

<!-- <P>
  <b>Connect PolicyKit to Slack</b>
  <BR>
  You must be an admin of the Slack to add PolicyKit to your workspace.<BR>
  <P>
    <a href="/authorize_platform?platform=slack&type=app">
      Install PolicyKit to Slack
    </a>
  </P>
  <P>
    <a href="/authorize_platform?platform=slack&type=user">
      Sign in with Slack
    </a>
  </P>
</P>

<BR>

{% if reddit_client_id %}
<P>
<b>Connect PolicyKit to Reddit</b>
<BR>

Because Reddit doesn't grant permissions on a subreddit by subreddit basis, you should create a Reddit account and make that account a moderator
with full permissions on your Reddit. Then, while logged in to that account, click below to grant PolicyKit permission to act on behalf of that account.


<BR>


<a href="https://www.reddit.com/api/v1/authorize?client_id={{reddit_client_id}}&response_type=code&state=policykit_reddit_mod_install&redirect_uri={{server_url}}%2Freddit%2Foauth&duration=permanent&scope=modcontributors,modmail,mysubreddits,modconfig,modflair,modothers,modtraffic,modself,modlog,modposts,modwiki,read,privatemessages,submit">
	Install PolicyKit to Reddit
</a>

</P>

<P>

You must be a subscriber to the Subreddit first.
<BR>
<a href="https://www.reddit.com/api/v1/authorize?client_id={{reddit_client_id}}&response_type=code&state=policykit_reddit_user_login&redirect_uri={{server_url}}%2Freddit%2Foauth&duration=permanent&scope=edit,flair,identity,mysubreddits,read,submit,save,vote">
	Sign in with Reddit
</a>

</P>
{% endif %}

<BR>

<P>
  <b>Connect PolicyKit to Discord</b>
  <BR>
  You must be an admin of the Discord to add PolicyKit to your server.<BR>
  <P>
    <a href="/authorize_platform?platform=discord&type=app">
      Install PolicyKit to Discord
    </a>
  </P>
  <P>
    <a href="/authorize_platform?platform=discord&type=user&redirect_uri={{server_url}}%2Fdiscord%2Flogin">
      Sign in with Discord
    </a>
  </P>
</P>

<BR>

<P>
<b>Connect PolicyKit to Discourse</b>

<BR>
You must be an admin of the Discourse to add PolicyKit to your community.<BR>

<a href="../discourse/configure?state=policykit_discourse_mod_install">
  Install PolicyKit to Discourse
</a>
</P>

<P>

<a href="../discourse/configure?state=policykit_discourse_user_login">
  Sign in with Discourse
</a>

</P> -->
{% endblock %}
